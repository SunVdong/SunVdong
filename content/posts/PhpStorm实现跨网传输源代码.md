+++
title = "PhpStorm实现跨网传输源代码"
date = 2023-11-09T11:15:56+08:00
draft = false
author = 'vdong'
categories = ['技术']
tags = ['SSH隧道']

+++

## 场景

本地开发代码，需要同步到 `10.21.30.81` 上， 但是本地只能通过 ssh 连接到 `10.21.30.80` 上，不能 ssh  连接到 `10.21.30.81` 上，因此需要将代码通过SFTP传到 80 上，再在 80 上 scp 到 81上，太麻烦了，网络如下：

![image-20231109112816186](/imgs/内网穿透/image-20231109112816186.png)

## SSH 隧道

在本机上执行

```shell
 ssh -L 2222:10.21.30.81:22 root@10.21.30.80
```

以上，本机上的 `2222` 端口会被监听，访问本机的 `2222` 端口，相当于访问 `10.21.30.81` 的 `22` 端口，即 ssh隧道建立在本机和 `10.21.30.80`之间。这个命令可以让你通过本地端口 `2222` 来访问远程主机 `10.21.30.81` 上的 SSH 服务。

在编辑器 Phpstrom 中配置 `Tools->Deployment->Configuration`,  添加 SFTP， 使用 `SSH` 连接 `127.0.0.1:2222`，即可实现代码自动上传。 

![image-20231109164954571](/imgs/内网穿透/image-20231109164954571.png)

与之类似的，执行

```shell
ssh -L 33060:10.21.30.81:3306 root@10.21.30.80
```

连接本地的 `127.0.0.1:33060`， 即可访问 `10.21.30.81:3306` 的 `mysql` 数据库。 

## 参考连接

[SSH隧道简明教程](https://www.lixueduan.com/posts/linux/07-ssh-tunnel/)
